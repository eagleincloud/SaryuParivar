<!doctype html>
{% load static %}
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="/media/saryu-parivaar-logo.png?v=4">
  <title>Saryu Parivar - Terms & Conditions</title>
  <link rel="stylesheet" href="https://unpkg.com/simplebar@latest/dist/simplebar.css"/>
  <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/metisMenu/3.0.7/metisMenu.min.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
</head>
<body class=" bg-[#ffecce]">

  <!-- dashboard -->
  <section class="wrapper">
    <div class="sidebar_wrapper" data-simplebar>
      <div class="simplebar-wrapper">
        <div class="simplebar-height-auto-observer-wrapper">
          <div class="simplebar-height-auto-observer"></div>
        </div>
        <div class="simplebar-mask">
          <div class="simplebar-offset">
            <div class="simplebar-content-wrapper">
              <div class="simplebar-content mm-active">
                <div class="sidebar-header">
                  <div style="position: relative; display: inline-block; padding: 12px; background: radial-gradient(circle, rgba(249, 119, 24, 0.15) 0%, transparent 75%); border-radius: 50%; box-shadow: 0 0 30px rgba(249, 119, 24, 0.2);">
                    <div style="position: relative; border-radius: 50%; overflow: hidden; padding: 4px; background: linear-gradient(135deg, rgba(249, 119, 24, 0.3) 0%, rgba(255, 255, 255, 0.1) 100%);">
                      <img src="/media/saryu-parivaar-logo.png?v=4" class="logo w-36" style="max-width: 200px; height: auto; border-radius: 50%; display: block; filter: drop-shadow(0 4px 12px rgba(249, 119, 24, 0.3)); position: relative; z-index: 1;" alt="Saryu Parivar Logo">
                      <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; border-radius: 50%; box-shadow: inset 0 0 30px rgba(255, 255, 255, 0.6), inset 0 0 60px rgba(249, 119, 24, 0.2); pointer-events: none; z-index: 2;"></div>
                      <div style="position: absolute; top: -2px; left: -2px; right: -2px; bottom: -2px; border-radius: 50%; background: linear-gradient(135deg, rgba(249, 119, 24, 0.4), rgba(255, 140, 66, 0.2), rgba(249, 119, 24, 0.4)); filter: blur(8px); z-index: 0; opacity: 0.7;"></div>
                    </div>
                  </div>
                  <div class="toggle-icon m-auto">
                    <i class="bx bx-arrow-to-left" id="btn"></i>
                  </div>
                </div>
                {% include 'includes/sidebar.html' %}
              </div>              
            </div>
          </div>
        </div>
        <div class="simplebar-placeholder"></div>
      </div>
      <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;">
        <div class="simplebar-scrollbar" style="width: 0px; display: none;"></div>
      </div>
      <div class="simplebar-track simplebar-vertical" style="visibility: visible;">
        <div class="simplebar-scrollbar" style="height: 83px; transform: translate3d(0px, 0px, 0px); display: block;"></div>
      </div>
    </div>
    <header>
      <div class="topbar d-flex align-items-center">
        <nav class="navbar navbar-expand">
          <div class="search-bar flex-grow-1">
            <div class="position-relative search-bar-box">
              <!-- <input type="text" class="form-control search-control" placeholder="Type to search...">
              <span class="position-absolute top-50 search-show translate-middle-y">
                <i class="bx bx-search"></i>
              </span>
              <span class="position-absolute top-50 search-close translate-middle-y">
                <i class="bx bx-x"></i>
              </span> -->
            </div>
          </div>
          <!-- Payment Verification Badge -->
          {% if payment_pending or not payment_done %}
          <div class="payment-badge-container me-3">
            <a href="/payment/" class="payment-verification-badge" title="{% if payment_pending %}Payment verification pending{% else %}Payment required{% endif %}" style="display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; border-radius: 20px; text-decoration: none; font-size: 12px; font-weight: 600; box-shadow: 0 2px 8px rgba(255, 152, 0, 0.3); transition: all 0.3s ease;">
              <i class="bx bx-time-five" style="font-size: 14px;"></i>
              <span class="d-none d-md-inline">{% if payment_pending %}Verification Pending{% else %}Payment Required{% endif %}</span>
              <span class="d-md-none">Pending</span>
            </a>
          </div>
          {% endif %}
          <div class="user-box dropdown">
            <a class="d-flex align-items-center nav-link dropdown-toggle dropdown-toggle-nocaret" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <img src="{{user_avatar}}" class="user-img" alt="user avatar">
              <div class="user-info ps-3">
                <p class="user-name mb-0">{{username}}</p>
                <!-- <p class="designattion mb-0">Web Designer</p> -->
              </div>
            </a>
            <ul class="dropdown-menu dropdown-menu-end">
              <li>
                <a href="{% url 'logout_user' %}" class="dropdown-item"><i class='bx bx-log-out-circle'></i> Logout</a>
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </header>
    <div class="page_wrapper">
      <div class="page-content">
        <style>
          .payment-verification-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.4);
          }
          .profile-blurred {
            filter: blur(5px);
            pointer-events: none;
            opacity: 0.6;
            user-select: none;
          }
          
          /* Payment Verification Overlay - Above blur */
          .payment-verification-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 25px 35px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3) !important;
            text-align: center;
            max-width: 85%;
            border: 3px solid #f97718;
            pointer-events: auto !important;
            backdrop-filter: blur(10px);
            filter: none !important; /* Ensure overlay is not blurred */
          }
          
          .payment-verification-overlay * {
            filter: none !important; /* Ensure all content inside is not blurred */
          }
          /* Mobile Responsive */
          @media (max-width: 768px) {
            .payment-badge-container {
              margin-right: 8px !important;
            }
            .payment-verification-badge {
              padding: 5px 10px !important;
              font-size: 11px !important;
            }
            .user-box {
              margin-left: auto;
            }
            .user-info {
              display: none;
            }
            .topbar {
              padding: 10px 15px !important;
            }
            .user-img {
              width: 35px !important;
              height: 35px !important;
            }
          }
        </style>
        {% if not payment_done %}
        <!-- Single Payment Verification Message - Shown Once at Top -->
        <div class="mx-3 mb-6" style="margin-top: 20px;">
          <div class="payment-verification-banner" style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); padding: 25px 35px; border-radius: 20px; box-shadow: 0 10px 40px rgba(255, 152, 0, 0.3); text-align: center; border: 3px solid #ff9800; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -50%; right: -20%; width: 300px; height: 300px; background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
              <i class="bx bx-lock-alt" style="font-size: 56px; color: white; margin-bottom: 15px; display: block; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));"></i>
              <h4 class="poppins font-bold mb-3" style="color: white; font-size: 22px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">Payment Verification Required</h4>
              <p class="poppins mb-4" style="color: white; font-size: 16px; line-height: 1.6; opacity: 0.95;">You are not verified. Please complete payment for verification to view profile details.</p>
              <a href="/payment/" class="inline-block bg-white text-[#ff9800] px-8 py-3 rounded-lg poppins hover:bg-[#fff5e6] transition-all duration-300 shadow-lg hover:shadow-xl" style="text-decoration: none; font-size: 16px; font-weight: 600; box-shadow: 0 4px 15px rgba(255,255,255,0.4);">
                <i class="bx bx-credit-card"></i> Make Payment
              </a>
            </div>
          </div>
        </div>
        {% endif %}
          <div class="grid">
            <div class="mx-3 mb-3">
              <div class="banner-form bg-white">
                <form class="form-row bg-[#ffecceab] py-3 sm:px-5 px-3 items-center grid lg:grid-cols-5 md:grid-cols-2 sm:grid-cols-1" id="filter-form">
                  {% csrf_token %}
                  <div class="mx-3 lg:mb-0 mb-3">
                    <label for="gender" class="poppins">I'm looking for a</label>
                    <select id="gender" name="gender" class="w-full p-1.5 bg-transparent border-b-[1px] border-[#000] poppins focus-visible:outline-0">
                      <option value="" selected>Select Gender</option>
                      {% for gender in genders %}
                        {% if gender %}
                          <option value="{{gender}}">{{gender}}</option>
                        {% endif %}
                      {% endfor %}
                    </select>
                  </div>
                  <div class="mx-3 lg:mb-0 mb-3">
                    <label for="age_lower_limit" class="poppins">Aged</label>
                    <div class="flex items-center">
                      <select id="age-lower-limit" name="age_lower_limit" class="w-full p-1.5 bg-transparent border-b-[1px] border-[#000] poppins focus-visible:outline-0">
                        <option value="" selected>Min</option>
                        {% for age in ages %}
                          {% if age %}
                            <option value="{{age}}">{{age}}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                      <div class="mx-2">to</div>
                      <select id="age-upper-limit" name="age_upper_limit" class="w-full p-1.5 bg-transparent border-b-[1px] border-[#000] poppins focus-visible:outline-0">
                        <option value="" selected>Max</option>
                        {% for age in ages %}
                          {% if age %}
                            <option value="{{age}}">{{age}}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                  <div class="mx-3 lg:mb-0 mb-3">
                    <label for="district" class="poppins">Location</label>
                    <select id="district" name="city" class="w-full p-1.5 bg-transparent border-b-[1px] border-[#000] poppins focus-visible:outline-0">
                      <option value="" selected></option>
                      {% for city in cities %}
                          <option value="{{city}}">{{city}}</option>
                      {% endfor %}
                    </select>
                  </div>
                  <div class="mx-3 lg:mb-0 mb-3">
                    <label for="education" class="poppins">Education</label>
                    <select id="education" name="education" class="w-full p-1.5 bg-transparent border-b-[1px] border-[#000] poppins focus-visible:outline-0">
                      <option value="" selected></option>
                      {% for education in educations %}
                          <option value="{{education}}">{{education}}</option>
                      {% endfor %}
                    </select>
                  </div>
                  <p id="data-filtered" hidden>False</p>
                  <div class="mb-0">
                    <button type="button" class="border-solid border-[1px] border-[#f97718] py-2.5 px-5 rounded-3xl bg-[#f97718] text-[#fff] poppins hover:bg-transparent hover:text-[#f97718] transition ease-in-out" id="filter-button" onclick="filter_marriage_profiles()">Let's Begin</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!-- DEBUG BANNER: This is the Browse Profiles page -->
          <div style="background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); padding: 20px; margin: 20px; border-radius: 10px; text-align: center; margin-bottom: 30px; border: 5px solid green;">
            <h1 style="color: white; font-size: 32px; font-weight: bold; margin: 0;">üîç BROWSE PROFILES PAGE</h1>
            <p style="color: rgba(255,255,255,0.9); margin: 10px 0 0 0; font-size: 18px;">This is the Browse All Profiles Page - URL: /dashboard/</p>
            <p style="color: yellow; margin: 10px 0 0 0; font-weight: bold;">If you see this, you are on the Browse Profiles page!</p>
          </div>
          <div class="grid grid-cols-1 lg:grid-cols-2" id="profile-list">
            {% if profiles %}
              {% for profile in profiles %}
                <div class="mx-3 mb-3" style="position: relative;">
                <div class="grid lg:grid-cols-3 grid-cols-1 items-center bg-white p-2" {% if not payment_done %}style="filter: blur(5px); pointer-events: none; opacity: 0.6;"{% endif %}>
                  <div class="mx-3">
                    <img src="{{profile.marriage_profile_pic.url|default:''}}" class="img-fluid w-full m-auto border-2 p-2 mb-2">
                    <h3 class="font-medium poppins me-2 text-center">{{profile.candidate_name|default:''}}</h3>
                  </div>
                  <div class="mx-3 col-span-2">
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Father:</h3>
                      <span class="poppins w-1/2">{{profile.father_name|default:''}}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Education:</h3>
                      <span class="poppins w-1/2">{{profile.education|default:''}}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Occupation:</h3>
                      <span class="poppins w-1/2">{{profile.occupation|default:''}}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Annual Income:</h3>
                      <span class="poppins w-1/2">{{profile.annual_income|default:''}}</span>
                    </div>              
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Height:</h3>
                      <span class="poppins w-1/2">{{profile.height|default:''}}</span>
                    </div>                
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Color:</h3>
                      <span class="poppins w-1/2">{{profile.color|default:''}}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Date of Birth</h3>
                      <span class="poppins w-1/2">{{profile.date_of_birth|default:''}}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Place of Birth:</h3>
                      <span class="poppins w-1/2">{{profile.birth_place|default:''}}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Gotra:</h3>
                      <span class="poppins w-1/2">{{profile.gotra|default:''}}</span>
                    </div>
                    {% if payment_done %}
                    <div class="flex mb-2 items-center justify-center mt-4 gap-2">
                      <button type="button" class="border-solid border-[1px] border-[#f97718] py-2.5 px-5 rounded-3xl bg-[#f97718] text-[#fff] poppins hover:bg-transparent hover:text-[#f97718] transition ease-in-out contact-btn" onclick="showContactModal('{{profile.id}}', '{{profile.candidate_name}}', '{{profile.phone_number}}', '{{profile.whatsapp_phone_number|default:""}}', '{{profile.email_id|default:""}}')" style="font-weight: 600;">
                        <i class="bx bx-phone"></i> Contact
                      </button>
                      <button type="button" class="shortlist-btn border-solid border-[1px] py-2.5 px-5 rounded-3xl poppins transition ease-in-out" 
                              onclick="toggleShortlist({{profile.id}})" 
                              data-profile-id="{{profile.id}}"
                              style="font-weight: 600; {% if profile.is_shortlisted %}border-[#f97718]; background: #f97718; color: #fff;{% else %}border-gray-400; background: transparent; color: #666;{% endif %}">
                        <i class="bx {% if profile.is_shortlisted %}bxs-heart{% else %}bx-heart{% endif %}"></i> 
                        <span class="shortlist-text">{% if profile.is_shortlisted %}Shortlisted{% else %}Shortlist{% endif %}</span>
                      </button>
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>
              {% endfor %}
            {% else %}
              <div class="col-span-2 mx-3 mb-3">
                <div class="bg-white p-8 rounded-lg text-center">
                  <i class="bx bx-user-x" style="font-size: 64px; color: #ccc; margin-bottom: 20px;"></i>
                  <h3 class="text-2xl font-semibold poppins mb-2" style="color: #666;">No Profiles Found</h3>
                  <p class="poppins mb-4" style="color: #999;">
                    {% if not payment_done %}
                      Please complete your payment verification to view profiles.
                    {% else %}
                      No profiles are available at the moment. Profiles will appear here once users create their matrimonial profiles.
                    {% endif %}
                  </p>
                  {% if not payment_done %}
                    <a href="/payment/" class="inline-block bg-[#f97718] text-white px-6 py-2 rounded-lg poppins hover:bg-[#e06615] transition">
                      Complete Payment
                    </a>
                  {% endif %}
                </div>
              </div>
            {% endif %}
          </div>
          <div class="grid">
            <div class="mx-3">
              <nav class="flex justify-center">
                <ul class="inline-flex -space-x-px text-base h-10">
                  {% for page_number in total_pages %}
                    <li>
                      <li>
                        <button type="button" class="flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-[#f97718] hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white page-number" onclick="selectElement(this)">{{page_number}}</button>
                      </li>
                    </li>
                  {% endfor %}
                  <!-- <li>
                    <button type="button" class="flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-[#f97718] hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white page-number" onclick="selectElement(this)">2</button>
                  </li> -->
                  
                </ul>
              </nav>
            </div>
          </div>
      </div>
    </div>
    <footer class="bg-black py-2 text-white poppins">
      <p class="text-center">Copyright &copy; 2024 Saryu Parivar. All Rights Reserved.</p>
      <p class="text-center mb-0">Proudly designed and developed by Eagle in Cloud</p>
    </footer>
  </section>
  <!-- end of dashboard --> 
  
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
  <script src="https://unpkg.com/simplebar@latest/dist/simplebar.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/metisMenu/3.0.7/metisMenu.min.js"></script>
  <script src="https://unpkg.com/boxicons@2.1.2/dist/boxicons.js"></script>
  <script src="{% static 'js/script.js' %}"></script>
  <script>
    // const button = document.getElementById('filter-button');
    const form = document.getElementById('filter-form');
    const profileList = document.getElementById('profile-list');
    // console.log(button)
    // console.log(form)
    // console.log(profileList)

    async function selectElement(clickedElement) {
            // Get all elements inside the container
            const allpageNumbers = document.querySelectorAll('.page-number');
            data_filtered_tag = document.getElementById('data-filtered')
            // console.log(allElements);
            // console.log(clickedElement.textContent);
            // console.log(data_filtered_tag.textContent);
            if (data_filtered_tag.textContent == 'False'){
              loadPageWithQueryParam(clickedElement.textContent)
            }else{
              filter_marriage_profiles(clickedElement.textContent)
            }
            
            // allElements.forEach(element => {
            //     element.classList.remove('flex', 'items-center', 'justify-center', 'px-4', 'h-10', 'text-[#fff]', 'border', 'border-gray-300', 'bg-[#f97718]', 'hover:bg-[#fff]', 'hover:text-[#f97718]', 'dark:border-gray-700', 'dark:bg-gray-700', 'dark:text-white');
            //     element.classList.add('flex', 'items-center', 'justify-center', 'px-4', 'h-10', 'leading-tight', 'text-gray-500', 'bg-white', 'border', 'border-[#f97718]', 'hover:bg-gray-100', 'hover:text-gray-700', 'dark:bg-gray-800', 'dark:border-gray-700', 'dark:text-gray-400', 'dark:hover:bg-gray-700', 'dark:hover:text-white');
            // });

            // // Add 'selected bold' to the clicked element
            // clickedElement.classList.remove('flex', 'items-center', 'justify-center', 'px-4', 'h-10', 'leading-tight', 'text-gray-500', 'bg-white', 'border', 'border-[#f97718]', 'hover:bg-gray-100', 'hover:text-gray-700', 'dark:bg-gray-800', 'dark:border-gray-700', 'dark:text-gray-400', 'dark:hover:bg-gray-700', 'dark:hover:text-white');
            // clickedElement.classList.add('flex', 'items-center', 'justify-center', 'px-4', 'h-10', 'text-[#fff]', 'border', 'border-gray-300', 'bg-[#f97718]', 'hover:bg-[#fff]', 'hover:text-[#f97718]', 'dark:border-gray-700', 'dark:bg-gray-700', 'dark:text-white');
        }

    function loadPageWithQueryParam(requested_page_number) {
      window.location.href = `${window.location.pathname}?page=${requested_page_number}`;
      // Make a GET request with the query parameter
      // fetch(`${window.location.href}?page=${requested_page_number}`)
      //     .then(response => response.text())  // Get the HTML response
      //     .then(html => {
      //         // Update the page content with the received HTML
      //         document.body.innerHTML = html;  // Replace the entire page with the new content
      //     })
      //     .catch(error => {
      //         console.error('Error:', error);
      //     });
    }

    async function filter_marriage_profiles(clicked_page_number=1) {
      data_filtered_tag = document.getElementById('data-filtered')
      const formData = new FormData(form);
      formData.append('page_number', clicked_page_number);

      // Send POST request to filter profiles
      const response = await fetch(window.location.href, {
          method: 'POST',
          body: formData,
          headers: {
              'X-CSRFToken': '{{ csrf_token }}',
          },
      });

      // Get the JSON response
      const data = await response.json();
      // console.log(data);
      
      const profiles = data.profiles;
      const paymentRequired = data.payment_required || false;

      // Show/hide payment banner based on payment status
      const paymentBanner = document.querySelector('.payment-verification-banner');
      if (paymentBanner) {
        if (paymentRequired) {
          paymentBanner.style.display = 'block';
        } else {
          paymentBanner.style.display = 'none';
        }
      }

      // // Update the profile list
      profileList.innerHTML = ''; // Clear current profiles
      
      if (profiles.length === 0) {
        profileList.innerHTML = `
          <div class="col-span-2 mx-3 mb-3">
            <div class="bg-white p-8 rounded-lg text-center">
              <i class="bx bx-user-x" style="font-size: 64px; color: #ccc; margin-bottom: 20px;"></i>
              <h3 class="text-2xl font-semibold poppins mb-2" style="color: #666;">No Profiles Found</h3>
              <p class="poppins mb-4" style="color: #999;">No profiles match your filter criteria. Please try different filters.</p>
            </div>
          </div>
        `;
        return;
      }
      
      profiles.forEach((profile) => {
          const blurStyle = paymentRequired ? 'style="filter: blur(5px); pointer-events: none; opacity: 0.6;"' : '';
          const isShortlisted = profile.is_shortlisted || false;
          const shortlistBtnStyle = isShortlisted ? 'border-[#f97718]; background: #f97718; color: #fff;' : 'border-gray-400; background: transparent; color: #666;';
          const shortlistIcon = isShortlisted ? 'bxs-heart' : 'bx-heart';
          const shortlistText = isShortlisted ? 'Shortlisted' : 'Shortlist';
          const profileCard = `
              <div class="mx-3 mb-3" style="position: relative;">
                <div class="grid lg:grid-cols-3 grid-cols-1 items-center bg-white p-2" ${blurStyle}>
                  <div class="mx-3">
                    <img src="${profile.marriage_profile_pic}" class="img-fluid w-full m-auto border-2 p-2 mb-2">
                    <h3 class="font-medium poppins me-2 text-center">${profile.candidate_name}</h3>
                  </div>
                  <div class="mx-3 col-span-2">
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Father:</h3>
                      <span class="poppins w-1/2">${profile.father_name}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Education:</h3>
                      <span class="poppins w-1/2">${profile.education}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Occupation:</h3>
                      <span class="poppins w-1/2">${profile.occupation}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Annual Income:</h3>
                      <span class="poppins w-1/2">${profile.annual_income}</span>
                    </div>              
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Height:</h3>
                      <span class="poppins w-1/2">${profile.height}</span>
                    </div>                
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Color:</h3>
                      <span class="poppins w-1/2">${profile.color}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Date of Birth</h3>
                      <span class="poppins w-1/2">${profile.date_of_birth}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Place of Birth:</h3>
                      <span class="poppins w-1/2">${profile.birth_place}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Gotra:</h3>
                      <span class="poppins w-1/2">${profile.gotra}</span>
                    </div>
                    <div class="flex mb-2 items-center">
                      <h3 class="font-medium poppins me-2 w-1/2">Phone Number:</h3>
                      <span class="poppins w-1/2">${profile.phone_number}</span>
                    </div>
                          ${!paymentRequired ? `
                          <div class="flex mb-2 items-center justify-center mt-4 gap-2">
                            <button type="button" class="border-solid border-[1px] border-[#f97718] py-2.5 px-5 rounded-3xl bg-[#f97718] text-[#fff] poppins hover:bg-transparent hover:text-[#f97718] transition ease-in-out contact-btn" onclick="showContactModal('${profile.id}', '${profile.candidate_name}', '${profile.phone_number}', '${profile.whatsapp_phone_number || ''}', '${profile.email_id || ''}')" style="font-weight: 600;">
                              <i class="bx bx-phone"></i> Contact
                            </button>
                            <button type="button" class="shortlist-btn border-solid border-[1px] py-2.5 px-5 rounded-3xl poppins transition ease-in-out" 
                                    onclick="toggleShortlist(${profile.id})" 
                                    data-profile-id="${profile.id}"
                                    style="font-weight: 600; ${shortlistBtnStyle}">
                              <i class="bx ${shortlistIcon}"></i> 
                              <span class="shortlist-text">${shortlistText}</span>
                            </button>
                          </div>
                          ` : ''}
                  </div>
                </div>
            </div>
          `;
          profileList.insertAdjacentHTML('beforeend', profileCard);
      });
      data_filtered_tag.textContent = 'True'
      // console.log(data_filtered_tag.textContent);
    }


    // button.addEventListener('click', async () => {
    //     console.log('Button clicked');
    //     const formData = new FormData(form);

    //     // Send POST request to filter profiles
    //     const response = await fetch(window.location.href, {
    //         method: 'POST',
    //         body: formData,
    //         headers: {
    //             'X-CSRFToken': '{{ csrf_token }}',
    //         },
    //     });

    //     // Get the JSON response
    //     const data = await response.json();
    //     const profiles = data.profiles;

    //     // Update the profile list
    //     profileList.innerHTML = ''; // Clear current profiles
    //     profiles.forEach((profile) => {
    //       const profileCard = `
    //             <div class="mx-3 mb-3">
    //                 <div class="grid lg:grid-cols-3 grid-cols-1 items-center bg-white p-2">
    //                     <div class="mx-3">
    //                         <img src="${profile.marriage_profile_pic}" class="img-fluid w-full m-auto border-2 p-2 mb-2">
    //                         <h3 class="font-medium poppins me-2 text-center">${profile.first_name} ${profile.last_name}</h3>
    //                     </div>
    //                     <div class="mx-3 col-span-2">
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Father:</h3>
    //                             <span class="poppins w-1/2">${profile.father_name}</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Education:</h3>
    //                             <span class="poppins w-1/2">${profile.education}</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Height:</h3>
    //                             <span class="poppins w-1/2">${profile.height_feet}'${profile.height_inches}"</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Color:</h3>
    //                             <span class="poppins w-1/2">${profile.color}</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Age:</h3>
    //                             <span class="poppins w-1/2">${profile.age}</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Place of Birth:</h3>
    //                             <span class="poppins w-1/2">${profile.native_village}</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Gotra:</h3>
    //                             <span class="poppins w-1/2">${profile.gotra}</span>
    //                         </div>
    //                         <div class="flex mb-2 items-center">
    //                             <h3 class="font-medium poppins me-2 w-1/2">Gender:</h3>
    //                             <span class="poppins w-1/2">${profile.gender}</span>
    //                         </div>
    //                     </div>
    //                 </div>
    //             </div>
    //         `;
    //         profileList.insertAdjacentHTML('beforeend', profileCard);
    //     });
    // });
    
    // Shortlist functionality
    async function toggleShortlist(profileId) {
      const btn = document.querySelector(`.shortlist-btn[data-profile-id="${profileId}"]`);
      if (!btn) return;
      
      const icon = btn.querySelector('i');
      const text = btn.querySelector('.shortlist-text');
      
      try {
        const response = await fetch(`/dashboard/toggle_shortlist/${profileId}/`, {
          method: 'POST',
          headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/json',
          },
        });
        
        const data = await response.json();
        
        if (data.success) {
          if (data.is_shortlisted) {
            btn.style.borderColor = '#f97718';
            btn.style.background = '#f97718';
            btn.style.color = '#fff';
            icon.className = 'bx bxs-heart';
            text.textContent = 'Shortlisted';
          } else {
            btn.style.borderColor = 'gray';
            btn.style.background = 'transparent';
            btn.style.color = '#666';
            icon.className = 'bx bx-heart';
            text.textContent = 'Shortlist';
          }
          
          // Show toast notification
          showToast(data.message, 'success');
        } else {
          showToast(data.error || 'Failed to update shortlist', 'error');
        }
      } catch (error) {
        console.error('Error toggling shortlist:', error);
        showToast('An error occurred. Please try again.', 'error');
      }
    }
    
    function showToast(message, type) {
      const toast = document.createElement('div');
      toast.className = `alert alert-${type === 'success' ? 'success' : 'danger'} poppins`;
      toast.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; min-width: 300px; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
  </script>
</body>
</html>